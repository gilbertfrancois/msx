100 ' Pattern
110 ' Gilbert Francois Duivesteijn
120 '
130 R=RND(-TIME)
135 COLOR 1,15,15
140 SCREEN 2: CLS
150 CM=8
160 DIM CO(CM,2)
170 CO(0,0)=4    ' blue
180 CO(0,1)=5
190 CO(1,0)=8    ' red
200 CO(1,1)=9
210 CO(2,0)=2    ' green
220 CO(2,1)=3
230 CO(3,0)=10   ' yellow
240 CO(3,1)=11
250 CO(4,0)=5    ' blue
260 CO(4,1)=7
270 CO(5,0)=8    ' red
280 CO(5,1)=11
290 CO(6,0)=12   ' green
300 CO(6,1)=2
301 CO(7,0)=13
302 CO(7,1)=4
310 RF=0         ' rnd fill threshold
320 'BS=8 : GOSUB 380
330 'BS=16: GOSUB 380
340 'BS=32: GOSUB 380
350 BS=64: GOSUB 380
360 IF INKEY$="r" GOTO 310 ELSE 360
370 END
380 '
390 ' fill screen
400 '
410 BH=BS*.5    ' half block size
420 FOR I=0 TO 191\BS
430 FOR J=0 TO 191\BS
440 K=I*(192\BS)+J
450 A0=32+BS*I      : B0=BS*J
460 A1=32+BS*(I+1)-1: B1=BS*(J+1)-1
470 IF BS=8 THEN GOSUB 510 ELSE IF RND(1) > RF THEN GOSUB 510
480 NEXT J
490 NEXT I
500 RETURN
510 '
520 ' Pattern selector
530 '
540 P=INT(RND(1)*2)+6
545 P=(K MOD 2) + 6
550 C0=K MOD CM
560 C1=INT(RND(1)*2)
570 C2=1-C1
580 C1=CO(C0,C1)
590 C2=CO(C0,C2)
600 IF P=1 THEN GOSUB 670
610 IF P=2 THEN GOSUB 730
620 IF P=3 THEN GOSUB 790
630 IF P=4 THEN GOSUB 880
640 IF P=5 THEN GOSUB 970
650 IF P=6 THEN GOSUB 1020
660 IF P=7 THEN GOSUB 1120
670 RETURN
680 ' Draw pattern 1
690 '
700 LINE(A0,B0)-(A1,B1),C1,BF
710 LINE(A0+BH,B0)-(A1,B1),C2,BF
720 RETURN
730 '
740 ' Draw pattern 2
750 '
760 LINE(A0,B0)-(A1,B1),C1,BF
770 LINE(A0,B0+BH)-(A1,B1),C2,BF
780 RETURN
790 '
800 ' Draw pattern 3
810 '
820 LINE(A0,B0)-(A1,B1),C1,BF
830 LINE(A0,B0)-(A1,B0),C2
840 LINE(A1,B0)-(A1,B1),C2
850 LINE(A1,B1)-(A0,B0),C2
860 PAINT(A1-1,B0+1),C2
870 RETURN
880 '
890 ' Draw pattern 4
900 '
910 LINE(A0,B0)-(A1,B1),C1,BF
920 LINE(A0,B0)-(A1,B0),C2
930 LINE(A1,B0)-(A0,B1),C2
940 LINE(A0,B1)-(A0,B0),C2
950 PAINT(A0+1,B0+1),C2
960 RETURN
970 '
980 ' Draw pattern 5
990 '
1000 LINE(A0,B0)-(A1,B1),C1,BF
1010 RETURN
1020 '
1030 ' Draw pattern 6
1040 '
1050 LINE(A0,B0)-(A1,B1),C1,BF
1060 CIRCLE(A0+BH,B0+BH),BH-2,C2
1070 PAINT(A0+BH,B0+BH),C2
1080 B4=.5*BH
1090 CIRCLE(A0+BH,B0+BH+B4-1),B4-2,C1
1100 PAINT(A0+BH,B0+BH+B4-1),C1
1110 RETURN
1120 '
1130 ' Draw pattern 7
1140 '
1150 LINE(A0,B0)-(A1,B1),C1,BF
1160 CIRCLE(A0+BH,B0+BH),BH-2,C2
1170 PAINT(A0+BH,B0+BH),C2
1180 B4=.5*BH
1190 CIRCLE(A0+BH,B0+BH-B4+1),B4-2,C1
1200 PAINT(A0+BH,B0+BH-B4+1),C1
1210 RETURN
