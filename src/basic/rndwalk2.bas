100 ' Lattice Random Walk
110 ' Gilbert Francois Duivesteijn
120 '
130 CLEAR
140 '
150 ' Settings
160 '
170 SD=RND(-TIME)
180 R0=4
190 NS=1000
191 NC=2
192 DIM CO(3)
193 CO(0)=1
194 CO(1)=1
195 CO(2)=14
200 X0=128+INT(32*RND(1)-16)
210 Y0= 96+INT(32*RND(1)-16)
220 '
230 ' Start
240 '
250 COLOR 1,15,15
260 SCREEN 2
270 '
280 ' Main loop
290 '
300 FOR RP=1 TO 3
310 R=R0^RP
320 FOR S=0 TO NS
330 DX=R*SGN(2*RND(1)-1)
340 DY=R*SGN(2*RND(1)-1)
350 X1=X0+DX
360 Y1=Y0+DY
370 IF X1<0 THEN X1=X1+256  :GOTO 420
380 IF Y1<0 THEN Y1=Y1+192  :GOTO 420
390 IF X1>255 THEN X1=X1-256:GOTO 420
400 IF Y1>191 THEN Y1=Y1-192:GOTO 420
410 LINE(X0,Y0)-(X1,Y1),CO(RP-1)
420 X0=X1
430 Y0=Y1
440 NEXT S
450 NS=NS/8
460 NEXT RP
470 GOTO 470
480 END
